@using WEBBANMP_NLCS.Models
@model DONDAT
@using System.Globalization
@{
    ViewBag.Title = "XemDonHang";
    Layout = "~/Views/Layout/_AccountLayout.cshtml";

    IEnumerable<CHITIETDONDAT> lstCT = (IEnumerable<CHITIETDONDAT>)ViewBag.CT;
}

<h2 class="title text-center">Xem chi tiết đơn hàng</h2>

<h3>Mã đơn hàng: @Model.DD_MA</h3>
<table class="table">
    <tr>
        <td class="col-5">
            <label>Tên khách hàng: @Model.KHACHHANG.KH_HOTEN</label>
        </td>

        <td>
            <label>Địa chỉ giao: @Model.DD_DIACHI</label>
        </td>
    </tr>

    <tr>
        <td>
            <label>Số điện thoại: @Model.DD_SDT</label>
        </td>

        <td>
            <label>Ngày đặt: @Model.DD_NGAYDAT</label>
        </td>
    </tr>

    <tr>
        <td>
            <label>Ghi chú: @Model.DD_GHICHU</label>
        </td>

        <td>

            @{
                switch (Model.DD_TRANGTHAI)
                {
                    case -1:
                        <label>Trạng thái: Đã hủy</label>
                        break;
                    case 0:
                        <label>Trạng thái: Chưa giao cho bên vận chuyển</label>
                        break;
                    case 1:
                        <label>Trạng thái: Đã giao cho bên vận chuyển</label>
                        break;
                    case 2:
                        <label>Trạng thái: Đã hoàn thành</label>
                        break;

                }
            }

        </td>

    </tr>
</table>

<br />

<div class="table-responsive cart_info">
    <table class="table table-condensed">
        <thead>
            <tr class="cart_menu">
                <td class="image">Sản phẩm</td>
                <td class="description"></td>
                <td class="price">Đơn giá</td>
                <td class="quantity">Số lượng</td>
                <td class="total">Thành tiền</td>
            </tr>
        </thead>
        <tbody>

            @foreach (var item in lstCT)
            {
                <tr>
                    <td class="cart_product">
                        <a><img src="@Url.Content("~/Content/HinhAnhSP/" + item.SANPHAM.SP_HINH)" class="img-cart" alt=""></a>
                    </td>
                    <td class="cart_description">
                        <h4><a href="@Url.Action("XemChiTiet", "SanPham", new { id = item.SP_MA })">@item.SANPHAM.SP_TEN</a></h4>
                        <p>Mã sản phẩm: @item.SP_MA</p> @Html.Hidden("MaSP", item.SP_MA)
                    </td>
                    <td class="cart_price">
                        <p>@string.Format(new CultureInfo("vi-VN"), "{0:#,##0}", item.GIABAN) VNĐ</p>
                    </td>
                    <td class="cart_price">

                        <p class="text-center"> @item.SOLUONG </p>

                    </td>
                    <td class="cart_total">
                        <p class="cart_total_price">@string.Format(new CultureInfo("vi-VN"), "{0:#,##0}", item.SOLUONG * item.GIABAN) VNĐ</p>
                    </td>

                </tr>
            }

        </tbody>
    </table>
</div>

<div class="text-right">
    <h3>Tổng: @Model.CHITIETDONDATs.Sum(n => n.SOLUONG) sản phẩm</h3>
    <h3>Tổng tiền: @Model.CHITIETDONDATs.Sum(n => n.GIABAN * n.SOLUONG).Value.ToString("#,##") VNĐ</h3>
</div>

<div>
    <h3>@Html.ActionLink("Trở về", "LichSuMuaHang")</h3>
</div>
